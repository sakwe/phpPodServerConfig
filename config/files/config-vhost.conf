<VirtualHost *:80> 
ServerName pod.wojtalik.be 
RedirectPermanent / https://pod.wojtalik.be/ 
</VirtualHost> 
<VirtualHost *:443> 
ServerName pod.wojtalik.be 

DocumentRoot /home/diaspora/diaspora/public



RewriteEngine On


RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
RewriteRule ^/(.*)$ balancer://upstream%{REQUEST_URI} [P,QSA,L]

 

<Proxy balancer://upstream>

BalancerMember http://127.0.0.1:3000

</Proxy>

 

ProxyRequests Off

ProxyVia On

ProxyPreserveHost On

RequestHeader set X_FORWARDED_PROTO https



<Proxy *>

Order allow,deny

Allow from all

</Proxy>



<Directory /home/diaspora/diaspora/public>

Allow from all

AllowOverride all

Options -MultiViews

</Directory>



SSLEngine On 
SSLCertificateFile /home/diaspora/certificate/pod.wojtalik.be/ssl_cert 
SSLCertificateKeyFile /home/diaspora/certificate/pod.wojtalik.be/ssl_key 
SSLCertificateChainFile /home/diaspora/certificate/pod.wojtalik.be/ssl_ca 
</VirtualHost> 
